

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Anoncreds Design &mdash; Hyperledger Indy SDK  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Building Indy SDK" href="../../rtd-building.html" />
    <link rel="prev" title="Indy CLI Design" href="../001-cli/README.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          


          
            <a href="../../rtd-index.html" class="icon icon-home"> Hyperledger Indy SDK
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          

<br><img style="background-color: #fff; height: unset; width: unset;" alt="Hyperledger Indy" src="_static/images/indy-logo.png" />
<br>
<a href="https://github.com/hyperledger/indy-sdk.git"><img style="padding: 0px; margin: auto auto auto auto;" alt="GitHub" src="_static/images/github_button.png"/></a>
&nbsp;<a href="https://stackoverflow.com/questions/tagged/hyperledger-fabric"><img style="padding: 0px; margin: auto auto auto auto;" alt="StackOverflow" src="_static/images/stackoverflow_button.png"/></a>
&nbsp;<a href="https://chat.hyperledger.org"><img style="padding: 0px; margin: auto auto auto auto;" alt="Rocket Chat" src="_static/images/rocketchat_button.png"/></a>

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/getting-started.html">Getting Started with Libindy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rtd-tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../rtd-design.html">Indy SDK Design</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../001-cli/README.html">Indy CLI Design</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Anoncreds Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#anoncreds-references">Anoncreds References</a></li>
<li class="toctree-l3"><a class="reference internal" href="#design-goals">Design Goals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#anoncreds-workflow">Anoncreds Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api">API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#issuer">Issuer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#prover">Prover</a></li>
<li class="toctree-l4"><a class="reference internal" href="#blob-storage">Blob Storage</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../rtd-building.html">Building Indy SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rtd-migration-guides.html">Libindy Migration Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-workflow.html">Release process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../signing-commits.html">Signing commits</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../rtd-index.html">Hyperledger Indy SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../rtd-index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../rtd-design.html">Indy SDK Design</a> &raquo;</li>
        
      <li>Anoncreds Design</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/design/002-anoncreds/README.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="anoncreds-design">
<span id="anoncreds-design"></span><h1>Anoncreds Design<a class="headerlink" href="#anoncreds-design" title="Permalink to this headline">¶</a></h1>
<p>Here you can find the requirements and design for Indy SDK Anoncreds workflow (including revocation).</p>
<ul class="simple">
<li><a class="reference external" href="#anoncreds-references">Anoncreds References</a></li>
<li><a class="reference external" href="#design-goals">Design Goals</a></li>
<li><a class="reference external" href="#anoncreds-workflow">Anoncreds Workflow</a></li>
<li><a class="reference external" href="#api">API</a></li>
</ul>
<div class="section" id="anoncreds-references">
<span id="anoncreds-references"></span><h2>Anoncreds References<a class="headerlink" href="#anoncreds-references" title="Permalink to this headline">¶</a></h2>
<p>Anoncreds protocol links:</p>
<ul class="simple">
<li><a class="reference external" href="#anoncreds-workflow">Anoncreds Workflow</a></li>
<li><a class="reference external" href="https://github.com/hyperledger/indy-node/blob/master/design/anoncreds.md#requirements">Anoncreds Requirements</a></li>
<li>Indy Node Anoncreds transactions:<ul>
<li><a class="reference external" href="https://github.com/hyperledger/indy-node/blob/master/design/anoncreds.md##schema">SCHEMA</a></li>
<li><a class="reference external" href="https://github.com/hyperledger/indy-node/blob/master/design/anoncreds.md##cred_def">CRED_DEF</a></li>
<li><a class="reference external" href="https://github.com/hyperledger/indy-node/blob/master/design/anoncreds.md##revoc_reg_def">REVOC_REG_DEF</a></li>
<li><a class="reference external" href="https://github.com/hyperledger/indy-node/blob/master/design/anoncreds.md##revoc_reg_entry">REVOC_REG_ENTRY</a></li>
<li><a class="reference external" href="https://github.com/hyperledger/indy-node/blob/master/design/anoncreds.md#timestamp-support-in-state">Timestamp Support in State</a></li>
<li><a class="reference external" href="https://github.com/hyperledger/indy-node/blob/master/design/anoncreds.md#get_obj">GET_OBJ</a></li>
<li><a class="reference external" href="https://github.com/hyperledger/indy-node/blob/master/design/anoncreds.md#issuer-key-rotation">Issuer Key Rotation</a></li>
</ul>
</li>
<li><a class="reference external" href="https://github.com/hyperledger/indy-crypto/blob/master/libindy-crypto/docs/AnonCred.pdf">Anoncreds Math</a></li>
<li><a class="reference external" href="https://github.com/hyperledger/indy-crypto/blob/master/libindy-crypto/docs/anoncreds-design.md">Anoncreds Protocol Crypto API</a></li>
</ul>
</div>
<div class="section" id="design-goals">
<span id="design-goals"></span><h2>Design Goals<a class="headerlink" href="#design-goals" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Indy SDK and Indy Node should use the same format for public Anoncreds entities (Schema, Credential Definition, Revocation Registry Definition, Revocation Registry Delta)</li>
<li>Indy SDK and Indy Node should use the same entities referencing approach</li>
<li>It should be possible to integrate additional credential signature and revocation schemas without breaking API changes</li>
<li>API should provide flexible and pluggable approach to handle revocation tails files</li>
<li>API should provide the way to calculate revocation witness values on cloud agent to avoid downloading of the hole tails file on edge devices</li>
</ul>
</div>
<div class="section" id="anoncreds-workflow">
<span id="anoncreds-workflow"></span><h2>Anoncreds Workflow<a class="headerlink" href="#anoncreds-workflow" title="Permalink to this headline">¶</a></h2>
<p><img src="./anoncreds-workflow.svg"></p>
</div>
<div class="section" id="api">
<span id="api"></span><h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="issuer">
<span id="issuer"></span><h3>Issuer<a class="headerlink" href="#issuer" title="Permalink to this headline">¶</a></h3>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Create credential schema entity that describes credential attributes list and allows credentials</span>
<span class="sd">/// interoperability.</span>
<span class="sd">///</span>
<span class="sd">/// Schema is public and intended to be shared with all anoncreds workflow actors usually by publishing SCHEMA transaction</span>
<span class="sd">/// to Indy distributed ledger.</span>
<span class="sd">///</span>
<span class="sd">/// It is IMPORTANT for current version POST Schema in Ledger and after that GET it from Ledger</span>
<span class="sd">/// with correct seq_no to save compatibility with Ledger.</span>
<span class="sd">/// After that can call indy_issuer_create_and_store_credential_def to build corresponding Credential Definition.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// command_handle: command handle to map callback to user context</span>
<span class="sd">/// issuer_did: DID of schema issuer</span>
<span class="sd">/// name: a name the schema</span>
<span class="sd">/// version: a version of the schema</span>
<span class="sd">/// attrs: a list of schema attributes descriptions</span>
<span class="sd">/// cb: Callback that takes command result as parameter</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// schema_id: identifier of created schema</span>
<span class="sd">/// schema_json: schema as json</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Anoncreds*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_issuer_create_schema</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="n">issuer_did</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="n">name</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="n">version</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="n">attrs</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                             </span><span class="n">schema_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"> </span><span class="n">schema_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Create credential definition entity that encapsulates credentials issuer DID, credential schema, secrets used for signing credentials</span>
<span class="sd">/// and secrets used for credentials revocation.</span>
<span class="sd">///</span>
<span class="sd">/// Credential definition entity contains private and public parts. Private part will be stored in the wallet. Public part</span>
<span class="sd">/// will be returned as json intended to be shared with all anoncreds workflow actors usually by publishing CRED_DEF transaction</span>
<span class="sd">/// to Indy distributed ledger.</span>
<span class="sd">///</span>
<span class="sd">/// It is IMPORTANT for current version GET Schema from Ledger with correct seq_no to save compatibility with Ledger.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet).</span>
<span class="sd">/// command_handle: command handle to map callback to user context.</span>
<span class="sd">/// issuer_did: a DID of the issuer signing cred_def transaction to the Ledger</span>
<span class="sd">/// schema_json: credential schema as a json</span>
<span class="sd">/// tag: allows to distinct between credential definitions for the same issuer and schema</span>
<span class="sd">/// signature_type: credential definition type (optional, &#39;CL&#39; by default) that defines credentials signature and revocation math. Supported types are:</span>
<span class="sd">/// - &#39;CL&#39;: Camenisch-Lysyanskaya credential signature type</span>
<span class="sd">/// config_json: type-specific configuration of credential definition as json:</span>
<span class="sd">/// - &#39;CL&#39;:</span>
<span class="sd">///   - support_revocation: whether to request non-revocation credential (optional, default false)</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// cred_def_id: identifier of created credential definition</span>
<span class="sd">/// cred_def_json: public part of created credential definition</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="sd">/// Anoncreds*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_issuer_create_and_store_credential_def</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                          </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                          </span><span class="n">issuer_did</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                          </span><span class="n">schema_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                          </span><span class="n">tag</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                          </span><span class="n">signature_type</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                          </span><span class="n">config_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                          </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                               </span><span class="n">cred_def_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                               </span><span class="n">cred_def_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Create a new revocation registry for the given credential definition as tuple of entities:</span>
<span class="sd">/// - Revocation registry definition that encapsulates credentials definition reference, revocation type specific configuration and</span>
<span class="sd">///   secrets used for credentials revocation</span>
<span class="sd">/// - Revocation registry state that stores the information about revoked entities in a non-disclosing way. The state can be</span>
<span class="sd">///   represented as ordered list of revocation registry entries were each entry represents the list of revocation or issuance operations.</span>
<span class="sd">///</span>
<span class="sd">/// Revocation registry definition entity contains private and public parts. Private part will be stored in the wallet. Public part</span>
<span class="sd">/// will be returned as json intended to be shared with all anoncreds workflow actors usually by publishing REVOC_REG_DEF transaction</span>
<span class="sd">/// to Indy distributed ledger.</span>
<span class="sd">///</span>
<span class="sd">/// Revocation registry state is stored on the wallet and also intended to be shared as the ordered list of REVOC_REG_ENTRY transactions.</span>
<span class="sd">/// This call initializes the state in the wallet and returns the initial entry.</span>
<span class="sd">///</span>
<span class="sd">/// Some revocation registry types (for example, &#39;CL_ACCUM&#39;) can require generation of binary blob called tails used to hide information about revoked credentials in public</span>
<span class="sd">/// revocation registry and intended to be distributed out of leger (REVOC_REG_DEF transaction will still contain uri and hash of tails).</span>
<span class="sd">/// This call requires access to pre-configured blob storage writer instance handle that will allow to write generated tails.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet).</span>
<span class="sd">/// command_handle: command handle to map callback to user context.</span>
<span class="sd">/// issuer_did: a DID of the issuer signing transaction to the Ledger</span>
<span class="sd">/// revoc_def_type: revocation registry type (optional, default value depends on credential definition type). Supported types are:</span>
<span class="sd">/// - &#39;CL_ACCUM&#39;: Type-3 pairing based accumulator. Default for &#39;CL&#39; credential definition type</span>
<span class="sd">/// tag: allows to distinct between revocation registries for the same issuer and credential definition</span>
<span class="sd">/// cred_def_id: id of stored in ledger credential definition</span>
<span class="sd">/// config_json: type-specific configuration of revocation registry as json:</span>
<span class="sd">/// - &#39;CL_ACCUM&#39;: {</span>
<span class="sd">///     &quot;issuance_type&quot;: (optional) type of issuance. Currently supported:</span>
<span class="sd">///         1) ISSUANCE_BY_DEFAULT: all indices are assumed to be issued and initial accumulator is calculated over all indices;</span>
<span class="sd">///            Revocation Registry is updated only during revocation.</span>
<span class="sd">///         2) ISSUANCE_ON_DEMAND: nothing is issued initially accumulator is 1 (used by default);</span>
<span class="sd">///     &quot;max_cred_num&quot;: maximum number of credentials the new registry can process (optional, default 100000)</span>
<span class="sd">/// }</span>
<span class="sd">/// tails_writer_handle: handle of blob storage to store tails</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// revoc_reg_id: identifier of created revocation registry definition</span>
<span class="sd">/// revoc_reg_def_json: public part of revocation registry definition</span>
<span class="sd">/// revoc_reg_entry_json: revocation registry entry that defines initial state of revocation registry</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="sd">/// Anoncreds*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_issuer_create_and_store_revoc_reg</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="n">blob_storage_writer_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="n">cred_def_id</span>:  <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="n">tag</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="n">revoc_def_type</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="n">config_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                          </span><span class="n">revoc_reg_def_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                          </span><span class="n">revoc_reg_def_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                          </span><span class="n">revoc_reg_entry_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Create credential offer that will be used by Prover for</span>
<span class="sd">/// credential request creation. Offer includes nonce and key correctness proof</span>
<span class="sd">/// for authentication between protocol steps and integrity checking.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// command_handle: command handle to map callback to user context</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet)</span>
<span class="sd">/// cred_def_id: id of credential definition stored in the wallet</span>
<span class="sd">/// cb: Callback that takes command result as parameter</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// credential offer json:</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;schema_id&quot;: string,</span>
<span class="sd">///         &quot;cred_def_id&quot;: string,</span>
<span class="sd">///         // Fields below can depend on Cred Def type</span>
<span class="sd">///         &quot;nonce&quot;: string,</span>
<span class="sd">///         &quot;key_correctness_proof&quot; : &lt;key_correctness_proof&gt;</span>
<span class="sd">///     }</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="sd">/// Anoncreds*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_issuer_create_credential_offer</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="n">cred_def_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                       </span><span class="n">cred_offer_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Check Cred Request for the given Cred Offer and issue Credential for the given Cred Request.</span>
<span class="sd">///</span>
<span class="sd">/// Cred Request must match Cred Offer. The credential definition and revocation registry definition</span>
<span class="sd">/// referenced in Cred Offer and Cred Request must be already created and stored into the wallet.</span>
<span class="sd">///</span>
<span class="sd">/// Information for this credential revocation will be store in the wallet as part of revocation registry under</span>
<span class="sd">/// generated cred_revoc_id local for this wallet.</span>
<span class="sd">///</span>
<span class="sd">/// This call returns revoc registry delta as json file intended to be shared as REVOC_REG_ENTRY transaction.</span>
<span class="sd">/// Note that it is possible to accumulate deltas to reduce ledger load.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet).</span>
<span class="sd">/// command_handle: command handle to map callback to user context.</span>
<span class="sd">/// cred_offer_json: a cred offer created by indy_issuer_create_credential_offer</span>
<span class="sd">/// cred_req_json: a credential request created by indy_prover_create_credential_req</span>
<span class="sd">/// cred_values_json: a credential containing attribute values for each of requested attribute names.</span>
<span class="sd">///     Example:</span>
<span class="sd">///     {</span>
<span class="sd">///      &quot;attr1&quot; : {&quot;raw&quot;: &quot;value1&quot;, &quot;encoded&quot;: &quot;value1_as_int&quot; },</span>
<span class="sd">///      &quot;attr2&quot; : {&quot;raw&quot;: &quot;value1&quot;, &quot;encoded&quot;: &quot;value1_as_int&quot; }</span>
<span class="sd">///     }</span>
<span class="sd">/// rev_reg_id: id of revocation registry stored in the wallet</span>
<span class="sd">/// blob_storage_reader_handle: configuration of blob storage reader handle that will allow to read revocation tails</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// cred_json: Credential json containing signed credential values</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;schema_id&quot;: string,</span>
<span class="sd">///         &quot;cred_def_id&quot;: string,</span>
<span class="sd">///         &quot;rev_reg_def_id&quot;, Optional&lt;string&gt;,</span>
<span class="sd">///         &quot;values&quot;: &lt;see cred_values_json above&gt;,</span>
<span class="sd">///         // Fields below can depend on Cred Def type</span>
<span class="sd">///         &quot;signature&quot;: &lt;signature&gt;,</span>
<span class="sd">///         &quot;signature_correctness_proof&quot;: &lt;signature_correctness_proof&gt;</span>
<span class="sd">///     }</span>
<span class="sd">/// cred_revoc_id: local id for revocation info (Can be used for revocation of this credential)</span>
<span class="sd">/// revoc_reg_delta_json: Revocation registry delta json with a newly issued credential</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_issuer_create_credential</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">cred_offer_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">cred_req_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">cred_values_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">rev_reg_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">blob_storage_reader_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                 </span><span class="n">cred_revoc_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                 </span><span class="n">revoc_reg_delta_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                 </span><span class="n">cred_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Revoke a credential identified by a cred_revoc_id (returned by indy_issuer_create_credential).</span>
<span class="sd">///</span>
<span class="sd">/// The corresponding credential definition and revocation registry must be already</span>
<span class="sd">/// created an stored into the wallet.</span>
<span class="sd">///</span>
<span class="sd">/// This call returns revoc registry delta as json file intended to be shared as REVOC_REG_ENTRY transaction.</span>
<span class="sd">/// Note that it is possible to accumulate deltas to reduce ledger load.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// command_handle: command handle to map callback to user context.</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet).</span>
<span class="sd">/// blob_storage_reader_cfg_handle: configuration of blob storage reader handle that will allow to read revocation tails</span>
<span class="sd">/// rev_reg_id: id of revocation registry stored in wallet</span>
<span class="sd">/// cred_revoc_id: local id for revocation info</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// revoc_reg_delta_json: Revocation registry delta json with a revoked credential</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_issuer_revoke_cred</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="n">blob_storage_reader_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="n">cred_revoc_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="n">revoc_reg_delta_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Merge two revocation registry deltas (returned by indy_issuer_create_credential or indy_issuer_revoke_credential) to accumulate common delta.</span>
<span class="sd">/// Send common delta to ledger to reduce the load.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// command_handle: command handle to map callback to user context.</span>
<span class="sd">/// rev_reg_delta_json: revocation registry delta.</span>
<span class="sd">/// other_rev_reg_delta_json: revocation registry delta for which PrevAccum value  is equal to current accum value of rev_reg_delta_json.</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// merged_rev_reg_delta: Merged revocation registry delta</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_issuer_merge_revocation_registry_deltas</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="n">rev_reg_delta_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="n">other_rev_reg_delta_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                                </span><span class="n">merged_rev_reg_delta</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="prover">
<span id="prover"></span><h3>Prover<a class="headerlink" href="#prover" title="Permalink to this headline">¶</a></h3>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Creates a master secret with a given id and stores it in the wallet.</span>
<span class="sd">/// The id must be unique.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet).</span>
<span class="sd">/// command_handle: command handle to map callback to user context.</span>
<span class="sd">/// master_secret_id: (optional, if not present random one will be generated) new master id</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// out_master_secret_id: Id of generated master secret</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_prover_create_master_secret</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                               </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                               </span><span class="n">master_secret_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                               </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                    </span><span class="n">out_master_secret_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Creates a credential request for the given credential offer.</span>
<span class="sd">///</span>
<span class="sd">/// The method creates a blinded master secret for a master secret identified by a provided name.</span>
<span class="sd">/// The master secret identified by the name must be already stored in the secure wallet (see prover_create_master_secret)</span>
<span class="sd">/// The blinded master secret is a part of the credential request.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// command_handle: command handle to map callback to user context</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet)</span>
<span class="sd">/// prover_did: a DID of the prover</span>
<span class="sd">/// cred_offer_json: credential offer as a json containing information about the issuer and a credential</span>
<span class="sd">/// cred_def_json: credential definition json related to &lt;cred_def_id&gt; in &lt;cred_offer_json&gt; </span>
<span class="sd">/// master_secret_id: the id of the master secret stored in the wallet</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// cred_req_json: Credential request json for creation of credential by Issuer</span>
<span class="sd">///     {</span>
<span class="sd">///      &quot;prover_did&quot; : string,</span>
<span class="sd">///      &quot;cred_def_id&quot; : string,</span>
<span class="sd">///         // Fields below can depend on Cred Def type</span>
<span class="sd">///      &quot;blinded_ms&quot; : &lt;blinded_master_secret&gt;,</span>
<span class="sd">///      &quot;blinded_ms_correctness_proof&quot; : &lt;blinded_ms_correctness_proof&gt;,</span>
<span class="sd">///      &quot;nonce&quot;: string</span>
<span class="sd">///    }</span>
<span class="sd">/// cred_req_metadata_json: Credential request metadata json for further processing of received form Issuer credential.</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_prover_create_credential_req</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                </span><span class="n">prover_did</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                </span><span class="n">cred_offer_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                </span><span class="n">cred_def_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                </span><span class="n">master_secret_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                     </span><span class="n">cred_req_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Check credential provided by Issuer for the given credential request,</span>
<span class="sd">/// updates the credential by a master secret and stores in a secure wallet.</span>
<span class="sd">///</span>
<span class="sd">/// To support efficient and flexible search the following tags will be created for stored credential:</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;schema_id&quot;: &lt;credential schema id&gt;,</span>
<span class="sd">///         &quot;schema_issuer_did&quot;: &lt;credential schema issuer did&gt;,</span>
<span class="sd">///         &quot;schema_name&quot;: &lt;credential schema name&gt;,</span>
<span class="sd">///         &quot;schema_version&quot;: &lt;credential schema version&gt;,</span>
<span class="sd">///         &quot;issuer_did&quot;: &lt;credential issuer did&gt;,</span>
<span class="sd">///         &quot;cred_def_id&quot;: &lt;credential definition id&gt;,</span>
<span class="sd">///         &quot;rev_reg_id&quot;: &lt;credential revocation registry id&gt;, // &quot;None&quot; as string if not present</span>
<span class="sd">///         // for every attribute in &lt;credential values&gt;</span>
<span class="sd">///         &quot;attr::&lt;attribute name&gt;::marker&quot;: &quot;1&quot;,</span>
<span class="sd">///         &quot;attr::&lt;attribute name&gt;::value&quot;: &lt;attribute raw value&gt;,</span>
<span class="sd">///     }</span>
<span class="sd">/// </span>
<span class="sd">/// #Params</span>
<span class="sd">/// command_handle: command handle to map callback to user context.</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet).</span>
<span class="sd">/// cred_id: (optional, default is a random one) identifier by which credential will be stored in the wallet</span>
<span class="sd">/// cred_req_metadata_json: a credential request metadata created by indy_prover_create_credential_req</span>
<span class="sd">/// cred_json: credential json received from issuer</span>
<span class="sd">/// cred_def_json: credential definition json related to &lt;cred_def_id&gt; in &lt;cred_json&gt;</span>
<span class="sd">/// rev_reg_def_json: revocation registry definition json related to &lt;rev_reg_def_id&gt; in &lt;cred_json&gt;</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// out_cred_id: identifier by which credential is stored in the wallet</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_prover_store_credential</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">cred_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">cred_req_metadata_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">cred_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">cred_def_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">rev_reg_def_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                </span><span class="n">out_cred_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Gets human readable credential by the given id.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet).</span>
<span class="sd">/// cred_id: Identifier by which requested credential is stored in the wallet</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// credential json:</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;referent&quot;: string, // cred_id in the wallet</span>
<span class="sd">///         &quot;attrs&quot;: {&quot;key1&quot;:&quot;raw_value1&quot;, &quot;key2&quot;:&quot;raw_value2&quot;},</span>
<span class="sd">///         &quot;schema_id&quot;: string,</span>
<span class="sd">///         &quot;cred_def_id&quot;: string,</span>
<span class="sd">///         &quot;rev_reg_id&quot;: Optional&lt;string&gt;,</span>
<span class="sd">///         &quot;cred_rev_id&quot;: Optional&lt;string&gt;</span>
<span class="sd">///     }</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_prover_get_credential</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">cred_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="w"></span>
<span class="w">                                             </span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">credential_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Gets human readable credentials according to the filter.</span>
<span class="sd">/// If filter is NULL, then all credentials are returned.</span>
<span class="sd">/// Credentials can be filtered by Issuer, credential_def and/or Schema.</span>
<span class="sd">///</span>
<span class="sd">/// NOTE: This method is deprecated because immediately returns all fetched credentials.</span>
<span class="sd">/// Use &lt;indy_prover_search_credentials&gt; to fetch records by small batches.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet).</span>
<span class="sd">/// filter_json: filter for credentials</span>
<span class="sd">///        {</span>
<span class="sd">///            &quot;schema_id&quot;: string, (Optional)</span>
<span class="sd">///            &quot;schema_issuer_did&quot;: string, (Optional)</span>
<span class="sd">///            &quot;schema_name&quot;: string, (Optional)</span>
<span class="sd">///            &quot;schema_version&quot;: string, (Optional)</span>
<span class="sd">///            &quot;issuer_did&quot;: string, (Optional)</span>
<span class="sd">///            &quot;cred_def_id&quot;: string, (Optional)</span>
<span class="sd">///        }</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// credentials json</span>
<span class="sd">///     [{</span>
<span class="sd">///         &quot;referent&quot;: string, // cred_id in the wallet</span>
<span class="sd">///         &quot;attrs&quot;: {&quot;key1&quot;:&quot;raw_value1&quot;, &quot;key2&quot;:&quot;raw_value2&quot;},</span>
<span class="sd">///         &quot;schema_id&quot;: string,</span>
<span class="sd">///         &quot;cred_def_id&quot;: string,</span>
<span class="sd">///         &quot;rev_reg_id&quot;: Optional&lt;string&gt;,</span>
<span class="sd">///         &quot;cred_rev_id&quot;: Optional&lt;string&gt;</span>
<span class="sd">///     }]</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_prover_get_credentials</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="n">filter_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="w"></span>
<span class="w">                                              </span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                              </span><span class="n">matched_credentials_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Search for credentials stored in wallet.</span>
<span class="sd">/// Credentials can be filtered by tags created during saving of credential.</span>
<span class="sd">///</span>
<span class="sd">/// Instead of immediately returning of fetched credentials</span>
<span class="sd">/// this call returns search_handle that can be used later</span>
<span class="sd">/// to fetch records by small batches (with indy_prover_fetch_credentials).</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet).</span>
<span class="sd">/// query_json: Wql style filter for credentials searching based on tags.</span>
<span class="sd">///     where wql query: indy-sdk/doc/design/011-wallet-query-language/README.md</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// search_handle: Search handle that can be used later to fetch records by small batches (with indy_prover_fetch_credentials)</span>
<span class="sd">/// total_count: Total count of records</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_prover_search_credentials</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">query_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="w"></span>
<span class="w">                                                 </span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                 </span><span class="n">search_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                 </span><span class="n">total_count</span>: <span class="kt">usize</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
<span class="w">                                                 </span>
<span class="sd">/// Fetch next credentials for search.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// search_handle: Search handle (created by indy_prover_search_credentials) </span>
<span class="sd">/// count: Count of credentials to fetch</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// credentials_json: List of human readable credentials:</span>
<span class="sd">///     [{</span>
<span class="sd">///         &quot;referent&quot;: string, // cred_id in the wallet</span>
<span class="sd">///         &quot;attrs&quot;: {&quot;key1&quot;:&quot;raw_value1&quot;, &quot;key2&quot;:&quot;raw_value2&quot;},</span>
<span class="sd">///         &quot;schema_id&quot;: string,</span>
<span class="sd">///         &quot;cred_def_id&quot;: string,</span>
<span class="sd">///         &quot;rev_reg_id&quot;: Optional&lt;string&gt;,</span>
<span class="sd">///         &quot;cred_rev_id&quot;: Optional&lt;string&gt;</span>
<span class="sd">///     }]</span>
<span class="sd">/// NOTE: The list of length less than the requested count means credentials search iterator is completed.</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w">  </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_prover_fetch_credentials</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">search_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">count</span>: <span class="kt">usize</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">command_handle_</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                  </span><span class="n">credentials_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>

<span class="sd">/// Close credentials search (make search handle invalid)</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// search_handle: Search handle (created by indy_prover_search_credentials)</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w">  </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_prover_close_credentials_search</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                    </span><span class="n">search_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                    </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">command_handle_</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w">                                                 </span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Gets human readable credentials matching the given proof request.</span>
<span class="sd">///</span>
<span class="sd">/// NOTE: This method is deprecated because immediately returns all fetched credentials.</span>
<span class="sd">/// Use &lt;indy_prover_search_credentials_for_proof_req&gt; to fetch records by small batches.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet).</span>
<span class="sd">/// proof_request_json: proof request json</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;name&quot;: string,</span>
<span class="sd">///         &quot;version&quot;: string,</span>
<span class="sd">///         &quot;nonce&quot;: string,</span>
<span class="sd">///         &quot;requested_attributes&quot;: { // set of requested attributes</span>
<span class="sd">///              &quot;&lt;attr_referent&gt;&quot;: &lt;attr_info&gt;, // see below</span>
<span class="sd">///              ...,</span>
<span class="sd">///         },</span>
<span class="sd">///         &quot;requested_predicates&quot;: { // set of requested predicates</span>
<span class="sd">///              &quot;&lt;predicate_referent&gt;&quot;: &lt;predicate_info&gt;, // see below</span>
<span class="sd">///              ...,</span>
<span class="sd">///          },</span>
<span class="sd">///         &quot;non_revoked&quot;: Optional&lt;&lt;non_revoc_interval&gt;&gt;, // see below,</span>
<span class="sd">///                        // If specified prover must proof non-revocation</span>
<span class="sd">///                        // for date in this interval for each attribute</span>
<span class="sd">///                        // (can be overridden on attribute level)</span>
<span class="sd">///     }</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// where</span>
<span class="sd">/// attr_referent: Proof-request local identifier of requested attribute</span>
<span class="sd">/// attr_info: Describes requested attribute</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;name&quot;: string, // attribute name, (case insensitive and ignore spaces)</span>
<span class="sd">///         &quot;restrictions&quot;: Optional&lt;filter_json&gt;, // see above</span>
<span class="sd">///         &quot;non_revoked&quot;: Optional&lt;&lt;non_revoc_interval&gt;&gt;, // see below,</span>
<span class="sd">///                        // If specified prover must proof non-revocation</span>
<span class="sd">///                        // for date in this interval this attribute</span>
<span class="sd">///                        // (overrides proof level interval)</span>
<span class="sd">///     }</span>
<span class="sd">/// predicate_referent: Proof-request local identifier of requested attribute predicate</span>
<span class="sd">/// predicate_info: Describes requested attribute predicate</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;name&quot;: attribute name, (case insensitive and ignore spaces)</span>
<span class="sd">///         &quot;p_type&quot;: predicate type (Currently &quot;&gt;=&quot; only)</span>
<span class="sd">///         &quot;p_value&quot;: int predicate value</span>
<span class="sd">///         &quot;restrictions&quot;: Optional&lt;filter_json&gt;, // see above</span>
<span class="sd">///         &quot;non_revoked&quot;: Optional&lt;&lt;non_revoc_interval&gt;&gt;, // see below,</span>
<span class="sd">///                        // If specified prover must proof non-revocation</span>
<span class="sd">///                        // for date in this interval this attribute</span>
<span class="sd">///                        // (overrides proof level interval)</span>
<span class="sd">///     }</span>
<span class="sd">/// non_revoc_interval: Defines non-revocation interval</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;from&quot;: Optional&lt;int&gt;, // timestamp of interval beginning</span>
<span class="sd">///         &quot;to&quot;: Optional&lt;int&gt;, // timestamp of interval ending</span>
<span class="sd">///     }</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// credentials_json: json with credentials for the given proof request.</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;requested_attrs&quot;: {</span>
<span class="sd">///             &quot;&lt;attr_referent&gt;&quot;: [{ cred_info: &lt;credential_info&gt;, interval: Optional&lt;non_revoc_interval&gt; }],</span>
<span class="sd">///             ...,</span>
<span class="sd">///         },</span>
<span class="sd">///         &quot;requested_predicates&quot;: {</span>
<span class="sd">///             &quot;requested_predicates&quot;: [{ cred_info: &lt;credential_info&gt;, timestamp: Optional&lt;integer&gt; }, { cred_info: &lt;credential_2_info&gt;, timestamp: Optional&lt;integer&gt; }],</span>
<span class="sd">///             &quot;requested_predicate_2_referent&quot;: [{ cred_info: &lt;credential_2_info&gt;, timestamp: Optional&lt;integer&gt; }]</span>
<span class="sd">///         }</span>
<span class="sd">///     }, where credential is</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;referent&quot;: &lt;string&gt;,</span>
<span class="sd">///         &quot;attrs&quot;: {&quot;attr_name&quot; : &quot;attr_raw_value&quot;},</span>
<span class="sd">///         &quot;schema_id&quot;: string,</span>
<span class="sd">///         &quot;cred_def_id&quot;: string,</span>
<span class="sd">///         &quot;rev_reg_id&quot;: Optional&lt;int&gt;,</span>
<span class="sd">///         &quot;cred_rev_id&quot;: Optional&lt;int&gt;,</span>
<span class="sd">///     }</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_prover_get_credentials_for_proof_req</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                        </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                        </span><span class="n">proof_request_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                        </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="w"></span>
<span class="w">                                                            </span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                            </span><span class="n">credentials_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Search for credentials matching the given proof request.</span>
<span class="sd">///</span>
<span class="sd">/// Instead of immediately returning of fetched credentials</span>
<span class="sd">/// this call returns search_handle that can be used later</span>
<span class="sd">/// to fetch records by small batches (with indy_prover_fetch_credentials_for_proof_req).</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet).</span>
<span class="sd">/// proof_request_json: proof request json</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;name&quot;: string,</span>
<span class="sd">///         &quot;version&quot;: string,</span>
<span class="sd">///         &quot;nonce&quot;: string,</span>
<span class="sd">///         &quot;requested_attributes&quot;: { // set of requested attributes</span>
<span class="sd">///              &quot;&lt;attr_referent&gt;&quot;: &lt;attr_info&gt;, // see below</span>
<span class="sd">///              ...,</span>
<span class="sd">///         },</span>
<span class="sd">///         &quot;requested_predicates&quot;: { // set of requested predicates</span>
<span class="sd">///              &quot;&lt;predicate_referent&gt;&quot;: &lt;predicate_info&gt;, // see below</span>
<span class="sd">///              ...,</span>
<span class="sd">///          },</span>
<span class="sd">///         &quot;non_revoked&quot;: Optional&lt;&lt;non_revoc_interval&gt;&gt;, // see below,</span>
<span class="sd">///                        // If specified prover must proof non-revocation</span>
<span class="sd">///                        // for date in this interval for each attribute</span>
<span class="sd">///                        // (can be overridden on attribute level)</span>
<span class="sd">///     }</span>
<span class="sd">/// extra_query_json:(Optional) List of extra queries that will be applied to correspondent attribute/predicate:</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;&lt;attr_referent&gt;&quot;: &lt;wql query&gt;,</span>
<span class="sd">///         &quot;&lt;predicate_referent&gt;&quot;: &lt;wql query&gt;,</span>
<span class="sd">///     }</span>
<span class="sd">/// where wql query: indy-sdk/doc/design/011-wallet-query-language/README.md</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// search_handle: Search handle that can be used later to fetch records by small batches (with indy_prover_fetch_credentials_for_proof_req)</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_prover_search_credentials_for_proof_req</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="n">proof_request_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="n">extra_query_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="w"></span>
<span class="w">                                                               </span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                               </span><span class="n">search_handle</span>: <span class="kt">i32</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>

<span class="sd">/// Fetch next credentials for the requested item using proof request search </span>
<span class="sd">/// handle (created by indy_prover_search_credentials_for_proof_req).</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// search_handle: Search handle (created by indy_prover_search_credentials_for_proof_req)</span>
<span class="sd">/// item_referent: Referent of attribute/predicate in the proof request</span>
<span class="sd">/// count: Count of credentials to fetch</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// credentials_json: List of credentials for the given proof request.</span>
<span class="sd">///     [{</span>
<span class="sd">///         cred_info: &lt;credential_info&gt;,</span>
<span class="sd">///         interval: Optional&lt;non_revoc_interval&gt;</span>
<span class="sd">///     }]</span>
<span class="sd">/// where </span>
<span class="sd">/// credential_info:</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;referent&quot;: &lt;string&gt;,</span>
<span class="sd">///         &quot;attrs&quot;: {&quot;attr_name&quot; : &quot;attr_raw_value&quot;},</span>
<span class="sd">///         &quot;schema_id&quot;: string,</span>
<span class="sd">///         &quot;cred_def_id&quot;: string,</span>
<span class="sd">///         &quot;rev_reg_id&quot;: Optional&lt;int&gt;,</span>
<span class="sd">///         &quot;cred_rev_id&quot;: Optional&lt;int&gt;,</span>
<span class="sd">///     }</span>
<span class="sd">/// non_revoc_interval:</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;from&quot;: Optional&lt;int&gt;, // timestamp of interval beginning</span>
<span class="sd">///         &quot;to&quot;: Optional&lt;int&gt;, // timestamp of interval ending</span>
<span class="sd">///     }</span>
<span class="sd">/// NOTE: The list of length less than the requested count means that search iterator</span>
<span class="sd">/// correspondent to the requested &lt;item_referent&gt; is completed.</span>
<span class="sd">/// </span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w">  </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_prover_fetch_credentials_for_proof_req</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="n">search_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="n">item_referent</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="n">count</span>: <span class="kt">usize</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">command_handle_</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                                    </span><span class="n">credentials_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>

<span class="sd">/// Close credentials search for proof request (make search handle invalid)</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// search_handle: Search handle (created by indy_prover_search_credentials_for_proof_req)</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w">  </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_prover_close_credentials_search_for_proof_req</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                  </span><span class="n">search_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                  </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">command_handle_</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w">                                                                                    </span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Creates a proof according to the given proof request</span>
<span class="sd">/// Either a corresponding credential with optionally revealed attributes or self-attested attribute must be provided</span>
<span class="sd">/// for each requested attribute (see indy_prover_get_credentials_for_pool_req).</span>
<span class="sd">/// A proof request may request multiple credentials from different schemas and different issuers.</span>
<span class="sd">/// All required schemas, public keys and revocation registries must be provided.</span>
<span class="sd">/// The proof request also contains nonce.</span>
<span class="sd">/// The proof contains either proof or self-attested attribute value for each requested attribute.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet).</span>
<span class="sd">/// command_handle: command handle to map callback to user context.</span>
<span class="sd">/// proof_request_json: proof request json</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;name&quot;: string,</span>
<span class="sd">///         &quot;version&quot;: string,</span>
<span class="sd">///         &quot;nonce&quot;: string,</span>
<span class="sd">///         &quot;requested_attributes&quot;: { // set of requested attributes</span>
<span class="sd">///              &quot;&lt;attr_referent&gt;&quot;: &lt;attr_info&gt;, // see below</span>
<span class="sd">///              ...,</span>
<span class="sd">///         },</span>
<span class="sd">///         &quot;requested_predicates&quot;: { // set of requested predicates</span>
<span class="sd">///              &quot;&lt;predicate_referent&gt;&quot;: &lt;predicate_info&gt;, // see below</span>
<span class="sd">///              ...,</span>
<span class="sd">///          },</span>
<span class="sd">///         &quot;non_revoked&quot;: Optional&lt;&lt;non_revoc_interval&gt;&gt;, // see below,</span>
<span class="sd">///                        // If specified prover must proof non-revocation</span>
<span class="sd">///                        // for date in this interval for each attribute</span>
<span class="sd">///                        // (can be overridden on attribute level)</span>
<span class="sd">///     }</span>
<span class="sd">/// requested_credentials_json: either a credential or self-attested attribute for each requested attribute</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;self_attested_attributes&quot;: {</span>
<span class="sd">///             &quot;self_attested_attribute_referent&quot;: string</span>
<span class="sd">///         },</span>
<span class="sd">///         &quot;requested_attributes&quot;: {</span>
<span class="sd">///             &quot;requested_attribute_referent_1&quot;: {&quot;cred_id&quot;: string, &quot;timestamp&quot;: Optional&lt;number&gt;, revealed: &lt;bool&gt; }},</span>
<span class="sd">///             &quot;requested_attribute_referent_2&quot;: {&quot;cred_id&quot;: string, &quot;timestamp&quot;: Optional&lt;number&gt;, revealed: &lt;bool&gt; }}</span>
<span class="sd">///         },</span>
<span class="sd">///         &quot;requested_predicates&quot;: {</span>
<span class="sd">///             &quot;requested_predicates_referent_1&quot;: {&quot;cred_id&quot;: string, &quot;timestamp&quot;: Optional&lt;number&gt; }},</span>
<span class="sd">///         }</span>
<span class="sd">///     }</span>
<span class="sd">/// master_secret_id: the id of the master secret stored in the wallet</span>
<span class="sd">/// schemas_json: all schemas json participating in the proof request</span>
<span class="sd">///     {</span>
<span class="sd">///         &lt;schema1_id&gt;: &lt;schema1_json&gt;,</span>
<span class="sd">///         &lt;schema2_id&gt;: &lt;schema2_json&gt;,</span>
<span class="sd">///         &lt;schema3_id&gt;: &lt;schema3_json&gt;,</span>
<span class="sd">///     }</span>
<span class="sd">/// credential_defs_json: all credential definitions json participating in the proof request</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;cred_def1_id&quot;: &lt;credential_def1_json&gt;,</span>
<span class="sd">///         &quot;cred_def2_id&quot;: &lt;credential_def2_json&gt;,</span>
<span class="sd">///         &quot;cred_def3_id&quot;: &lt;credential_def3_json&gt;,</span>
<span class="sd">///     }</span>
<span class="sd">/// rev_states_json: all revocation states json participating in the proof request</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;rev_reg_def1_id&quot;: {</span>
<span class="sd">///             &quot;timestamp1&quot;: &lt;rev_state1&gt;,</span>
<span class="sd">///             &quot;timestamp2&quot;: &lt;rev_state2&gt;,</span>
<span class="sd">///         },</span>
<span class="sd">///         &quot;rev_reg_def2_id&quot;: {</span>
<span class="sd">///             &quot;timestamp3&quot;: &lt;rev_state3&gt;</span>
<span class="sd">///         },</span>
<span class="sd">///         &quot;rev_reg_def3_id&quot;: {</span>
<span class="sd">///             &quot;timestamp4&quot;: &lt;rev_state4&gt;</span>
<span class="sd">///         },</span>
<span class="sd">///     }</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// where</span>
<span class="sd">/// wql query: indy-sdk/doc/design/011-wallet-query-language/README.md</span>
<span class="sd">/// attr_referent: Proof-request local identifier of requested attribute</span>
<span class="sd">/// attr_info: Describes requested attribute</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;name&quot;: string, // attribute name, (case insensitive and ignore spaces)</span>
<span class="sd">///         &quot;restrictions&quot;: Optional&lt;filter_json&gt; // see above.</span>
<span class="sd">///         &quot;non_revoked&quot;: Optional&lt;&lt;non_revoc_interval&gt;&gt;, // see below,</span>
<span class="sd">///                        // If specified prover must proof non-revocation</span>
<span class="sd">///                        // for date in this interval this attribute</span>
<span class="sd">///                        // (overrides proof level interval)</span>
<span class="sd">///     }</span>
<span class="sd">/// predicate_referent: Proof-request local identifier of requested attribute predicate</span>
<span class="sd">/// predicate_info: Describes requested attribute predicate</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;name&quot;: attribute name, (case insensitive and ignore spaces)</span>
<span class="sd">///         &quot;p_type&quot;: predicate type (Currently &gt;= only)</span>
<span class="sd">///         &quot;p_value&quot;: predicate value</span>
<span class="sd">///         &quot;restrictions&quot;: Optional&lt;wql query&gt;,</span>
<span class="sd">///         &quot;non_revoked&quot;: Optional&lt;&lt;non_revoc_interval&gt;&gt;, // see below,</span>
<span class="sd">///                        // If specified prover must proof non-revocation</span>
<span class="sd">///                        // for date in this interval this attribute</span>
<span class="sd">///                        // (overrides proof level interval)</span>
<span class="sd">///     }</span>
<span class="sd">/// non_revoc_interval: Defines non-revocation interval</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;from&quot;: Optional&lt;int&gt;, // timestamp of interval beginning</span>
<span class="sd">///         &quot;to&quot;: Optional&lt;int&gt;, // timestamp of interval ending</span>
<span class="sd">///     }</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// Proof json</span>
<span class="sd">/// For each requested attribute either a proof (with optionally revealed attribute value) or</span>
<span class="sd">/// self-attested attribute value is provided.</span>
<span class="sd">/// Each proof is associated with a credential and corresponding schema_id, cred_def_id, rev_reg_id and timestamp.</span>
<span class="sd">/// There is also aggregated proof part common for all credential proofs.</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;requested&quot;: {</span>
<span class="sd">///             &quot;revealed_attrs&quot;: {</span>
<span class="sd">///                 &quot;requested_attr1_id&quot;: {sub_proof_index: number, raw: string, encoded: string},</span>
<span class="sd">///                 &quot;requested_attr4_id&quot;: {sub_proof_index: number: string, encoded: string},</span>
<span class="sd">///             },</span>
<span class="sd">///             &quot;unrevealed_attrs&quot;: {</span>
<span class="sd">///                 &quot;requested_attr3_id&quot;: {sub_proof_index: number}</span>
<span class="sd">///             },</span>
<span class="sd">///             &quot;self_attested_attrs&quot;: {</span>
<span class="sd">///                 &quot;requested_attr2_id&quot;: self_attested_value,</span>
<span class="sd">///             },</span>
<span class="sd">///             &quot;requested_predicates&quot;: {</span>
<span class="sd">///                 &quot;requested_predicate_1_referent&quot;: {sub_proof_index: int},</span>
<span class="sd">///                 &quot;requested_predicate_2_referent&quot;: {sub_proof_index: int},</span>
<span class="sd">///             }</span>
<span class="sd">///         }</span>
<span class="sd">///         &quot;proof&quot;: {</span>
<span class="sd">///             &quot;proofs&quot;: [ &lt;credential_proof&gt;, &lt;credential_proof&gt;, &lt;credential_proof&gt; ],</span>
<span class="sd">///             &quot;aggregated_proof&quot;: &lt;aggregated_proof&gt;</span>
<span class="sd">///         }</span>
<span class="sd">///         &quot;identifiers&quot;: [{schema_id, cred_def_id, Optional&lt;rev_reg_id&gt;, Optional&lt;timestamp&gt;}]</span>
<span class="sd">///     }</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_prover_create_proof</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">wallet_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">proof_req_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">requested_credentials_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">master_secret_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">schemas_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">credential_defs_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">rev_states_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                            </span><span class="n">proof_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Verifies a proof (of multiple credential).</span>
<span class="sd">/// All required schemas, public keys and revocation registries must be provided.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// wallet_handle: wallet handler (created by open_wallet).</span>
<span class="sd">/// command_handle: command handle to map callback to user context.</span>
<span class="sd">/// proof_request_json: proof request json</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;name&quot;: string,</span>
<span class="sd">///         &quot;version&quot;: string,</span>
<span class="sd">///         &quot;nonce&quot;: string,</span>
<span class="sd">///         &quot;requested_attributes&quot;: { // set of requested attributes</span>
<span class="sd">///              &quot;&lt;attr_referent&gt;&quot;: &lt;attr_info&gt;, // see below</span>
<span class="sd">///              ...,</span>
<span class="sd">///         },</span>
<span class="sd">///         &quot;requested_predicates&quot;: { // set of requested predicates</span>
<span class="sd">///              &quot;&lt;predicate_referent&gt;&quot;: &lt;predicate_info&gt;, // see below</span>
<span class="sd">///              ...,</span>
<span class="sd">///          },</span>
<span class="sd">///         &quot;non_revoked&quot;: Optional&lt;&lt;non_revoc_interval&gt;&gt;, // see below,</span>
<span class="sd">///                        // If specified prover must proof non-revocation</span>
<span class="sd">///                        // for date in this interval for each attribute</span>
<span class="sd">///                        // (can be overridden on attribute level)</span>
<span class="sd">///     }</span>
<span class="sd">/// proof_json: created for request proof json</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;requested&quot;: {</span>
<span class="sd">///             &quot;revealed_attrs&quot;: {</span>
<span class="sd">///                 &quot;requested_attr1_id&quot;: {sub_proof_index: number, raw: string, encoded: string},</span>
<span class="sd">///                 &quot;requested_attr4_id&quot;: {sub_proof_index: number: string, encoded: string},</span>
<span class="sd">///             },</span>
<span class="sd">///             &quot;unrevealed_attrs&quot;: {</span>
<span class="sd">///                 &quot;requested_attr3_id&quot;: {sub_proof_index: number}</span>
<span class="sd">///             },</span>
<span class="sd">///             &quot;self_attested_attrs&quot;: {</span>
<span class="sd">///                 &quot;requested_attr2_id&quot;: self_attested_value,</span>
<span class="sd">///             },</span>
<span class="sd">///             &quot;requested_predicates&quot;: {</span>
<span class="sd">///                 &quot;requested_predicate_1_referent&quot;: {sub_proof_index: int},</span>
<span class="sd">///                 &quot;requested_predicate_2_referent&quot;: {sub_proof_index: int},</span>
<span class="sd">///             }</span>
<span class="sd">///         }</span>
<span class="sd">///         &quot;proof&quot;: {</span>
<span class="sd">///             &quot;proofs&quot;: [ &lt;credential_proof&gt;, &lt;credential_proof&gt;, &lt;credential_proof&gt; ],</span>
<span class="sd">///             &quot;aggregated_proof&quot;: &lt;aggregated_proof&gt;</span>
<span class="sd">///         }</span>
<span class="sd">///         &quot;identifiers&quot;: [{schema_id, cred_def_id, Optional&lt;rev_reg_id&gt;, Optional&lt;timestamp&gt;}]</span>
<span class="sd">///     }</span>
<span class="sd">/// schemas_json: all schema jsons participating in the proof</span>
<span class="sd">///     {</span>
<span class="sd">///         &lt;schema1_id&gt;: &lt;schema1_json&gt;,</span>
<span class="sd">///         &lt;schema2_id&gt;: &lt;schema2_json&gt;,</span>
<span class="sd">///         &lt;schema3_id&gt;: &lt;schema3_json&gt;,</span>
<span class="sd">///     }</span>
<span class="sd">/// credential_defs_json: all credential definitions json participating in the proof</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;cred_def1_id&quot;: &lt;credential_def1_json&gt;,</span>
<span class="sd">///         &quot;cred_def2_id&quot;: &lt;credential_def2_json&gt;,</span>
<span class="sd">///         &quot;cred_def3_id&quot;: &lt;credential_def3_json&gt;,</span>
<span class="sd">///     }</span>
<span class="sd">/// rev_reg_defs_json: all revocation registry definitions json participating in the proof</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;rev_reg_def1_id&quot;: &lt;rev_reg_def1_json&gt;,</span>
<span class="sd">///         &quot;rev_reg_def2_id&quot;: &lt;rev_reg_def2_json&gt;,</span>
<span class="sd">///         &quot;rev_reg_def3_id&quot;: &lt;rev_reg_def3_json&gt;,</span>
<span class="sd">///     }</span>
<span class="sd">/// rev_regs_json: all revocation registries json participating in the proof</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;rev_reg_def1_id&quot;: {</span>
<span class="sd">///             &quot;timestamp1&quot;: &lt;rev_reg1&gt;,</span>
<span class="sd">///             &quot;timestamp2&quot;: &lt;rev_reg2&gt;,</span>
<span class="sd">///         },</span>
<span class="sd">///         &quot;rev_reg_def2_id&quot;: {</span>
<span class="sd">///             &quot;timestamp3&quot;: &lt;rev_reg3&gt;</span>
<span class="sd">///         },</span>
<span class="sd">///         &quot;rev_reg_def3_id&quot;: {</span>
<span class="sd">///             &quot;timestamp4&quot;: &lt;rev_reg4&gt;</span>
<span class="sd">///         },</span>
<span class="sd">///     }</span>
<span class="sd">/// cb: Callback that takes command result as parameter.</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// valid: true - if signature is valid, false - otherwise</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Annoncreds*</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_verifier_verify_proof</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">proof_request_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">proof_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">schemas_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">credential_defs_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">rev_reg_defs_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">rev_regs_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                              </span><span class="n">valid</span>: <span class="kt">bool</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Create revocation state for a credential in the particular time moment.</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// command_handle: command handle to map callback to user context</span>
<span class="sd">/// blob_storage_reader_handle: configuration of blob storage reader handle that will allow to read revocation tails</span>
<span class="sd">/// rev_reg_def_json: revocation registry definition json</span>
<span class="sd">/// rev_reg_delta_json: revocation registry definition delta json</span>
<span class="sd">/// timestamp: time represented as a total number of seconds from Unix Epoch</span>
<span class="sd">/// cred_rev_id: user credential revocation id in revocation registry</span>
<span class="sd">/// cb: Callback that takes command result as parameter</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// revocation state json:</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;rev_reg&quot;: &lt;revocation registry&gt;,</span>
<span class="sd">///         &quot;witness&quot;: &lt;witness&gt;,</span>
<span class="sd">///         &quot;timestamp&quot; : integer</span>
<span class="sd">///     }</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="sd">/// Anoncreds*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_create_revocation_state</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">blob_storage_reader_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">rev_reg_def_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">rev_reg_delta_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">timestamp</span>: <span class="kt">u64</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">cred_rev_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="w"></span>
<span class="w">                                               </span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                               </span><span class="n">rev_state_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="w"></span>
<span class="w">                                           </span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-Rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Create new revocation state for a credential based on existed state</span>
<span class="sd">/// at the particular time moment (to reduce calculation time).</span>
<span class="sd">///</span>
<span class="sd">/// #Params</span>
<span class="sd">/// command_handle: command handle to map callback to user context</span>
<span class="sd">/// blob_storage_reader_handle: configuration of blob storage reader handle that will allow to read revocation tails</span>
<span class="sd">/// rev_state_json: revocation registry state json</span>
<span class="sd">/// rev_reg_def_json: revocation registry definition json</span>
<span class="sd">/// rev_reg_delta_json: revocation registry definition delta json</span>
<span class="sd">/// timestamp: time represented as a total number of seconds from Unix Epoch</span>
<span class="sd">/// cred_rev_id: user credential revocation id in revocation registry</span>
<span class="sd">/// cb: Callback that takes command result as parameter</span>
<span class="sd">///</span>
<span class="sd">/// #Returns</span>
<span class="sd">/// revocation state json:</span>
<span class="sd">///     {</span>
<span class="sd">///         &quot;rev_reg&quot;: &lt;revocation registry&gt;,</span>
<span class="sd">///         &quot;witness&quot;: &lt;witness&gt;,</span>
<span class="sd">///         &quot;timestamp&quot; : integer</span>
<span class="sd">///     }</span>
<span class="sd">///</span>
<span class="sd">/// #Errors</span>
<span class="sd">/// Common*</span>
<span class="sd">/// Wallet*</span>
<span class="sd">/// Anoncreds*</span>
<span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span> <span class="nf">indy_update_revocation_state</span><span class="p">(</span><span class="n">command_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">blob_storage_reader_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">rev_state_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">rev_reg_def_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">rev_reg_delta_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">timestamp</span>: <span class="kt">u64</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">cred_rev_id</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">cb</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="k">extern</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="w"></span>
<span class="w">                                               </span><span class="n">xcommand_handle</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="n">err</span>: <span class="nc">ErrorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">                                               </span><span class="n">updated_rev_state_json</span>: <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">c_char</span><span class="w"></span>
<span class="w">                                           </span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ErrorCode</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="blob-storage">
<span id="blob-storage"></span><h3>Blob Storage<a class="headerlink" href="#blob-storage" title="Permalink to this headline">¶</a></h3>
<p>CL revocation schema introduces Revocation Tails entity used to hide information about revoked credential in public Revocation Registry. Tails</p>
<ul class="simple">
<li>are static (once generated) array of BigIntegers that can be represented as binary blob or file</li>
<li>may require quite huge amount of data (up to 1GB per Revocation Registry);</li>
<li>are created and shared by Issuers;</li>
<li>are required (so must be available for download) for both Provers and Issuers;</li>
<li>can be cached and can be downloaded only once;</li>
<li>Some operation (incremental witness updates) can require reading only small part of blob file. It can be more efficient to store complete tails blob in the cloud and ask for small parts through network.</li>
</ul>
<p>As result the way how to access tails blobs can be very application specific. To address this SDK will provide the following:</p>
<ul class="simple">
<li>API for registering custom handler for blobs reading</li>
<li>API for registering custom handler for blobs writing</li>
<li>API for blob consistency validation</li>
<li>Default handlers implementation that will allow to read blobs from local file and write blobs to local file.</li>
</ul>
<p>Tails publishing and access workflow can be integrated with Indy Node in the following way:</p>
<ul class="simple">
<li>Issuer generates tails and writes tails blob to local file (with default handler). Our API will also provide blob hash to him and generate URI based on configurable URI pattern.</li>
<li>Issuer uploads blob to some CDN with corresponded URI (out of SDK scope)</li>
<li>Issuer sends REVOC_REG_DEF transaction with and publishes tails URI and hash</li>
<li>Prover sends GET_REVOC_REG_DEF requests and receives tails URI and hash</li>
<li>Prover downloads published tails file and stores it locally (Out of SDK)</li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../rtd-building.html" class="btn btn-neutral float-right" title="Building Indy SDK" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../001-cli/README.html" class="btn btn-neutral" title="Indy CLI Design" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Hyperledger

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>