package org.hyperledger.indy.sdk.ledger;

import org.json.JSONObject;
import org.junit.Test;

public class RevocRegEntryRequestTest extends LedgerIntegrationTest {

	@Test
	public void testBuildRevocRegEntryRequestWorks() throws Exception {
		JSONObject expectedResult = new JSONObject()
				.put("operation", new JSONObject()
						.put("type", "114")
						.put("revocRegDefId", revRegDefId)
						.put("revocDefType", "CL_ACCUM")
						.put("value", new JSONObject()
								.put("accum", "1 0000000000000000000000000000000000000000000000000000000000000000 1 0000000000000000000000000000000000000000000000000000000000000000 1 0000000000000000000000000000000000000000000000000000000000000000 1 0000000000000000000000000000000000000000000000000000000000000000 1 0000000000000000000000000000000000000000000000000000000000000000 1 0000000000000000000000000000000000000000000000000000000000000000")
						)
				);

		String value = new JSONObject()
				.put("ver", "1.0")
				.put("value", new JSONObject()
						.put("accum", "1 0000000000000000000000000000000000000000000000000000000000000000 1 0000000000000000000000000000000000000000000000000000000000000000 1 0000000000000000000000000000000000000000000000000000000000000000 1 0000000000000000000000000000000000000000000000000000000000000000 1 0000000000000000000000000000000000000000000000000000000000000000 1 0000000000000000000000000000000000000000000000000000000000000000")
				).toString();

		String request = Ledger.buildRevocRegEntryRequest(DID, revRegDefId, "CL_ACCUM", value).get();

		assert (new JSONObject(request).toMap().entrySet()
				.containsAll(
						expectedResult.toMap().entrySet()));
	}
}
