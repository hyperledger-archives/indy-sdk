<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1191px" preserveAspectRatio="none" style="width:1121px;height:1191px;" version="1.1" viewBox="0 0 1121 1191" width="1121px" zoomAndPan="magnify"><defs><filter height="300%" id="fpy34uyqqo0p3" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="100.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="410" y="260.2266"/><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="410" y="573.5547"/><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="71.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="410" y="1014.5469"/><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="211.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="673" y="289.3594"/><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="169.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="673" y="602.6875"/><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="71.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="673" y="871.0156"/><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="98.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="994" y="772.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="96" x2="96" y1="86.2969" y2="1103.8125"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="415" x2="415" y1="86.2969" y2="1103.8125"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="678" x2="678" y1="86.2969" y2="1103.8125"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="999" x2="999" y1="86.2969" y2="1103.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="58" y="82.9951">Client app</text><ellipse cx="96" cy="13" fill="#FEFECE" filter="url(#fpy34uyqqo0p3)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M96,21 L96,48 M83,29 L109,29 M96,48 L83,63 M96,48 L109,63 " fill="none" filter="url(#fpy34uyqqo0p3)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="58" y="1115.8076">Client app</text><ellipse cx="96" cy="1129.1094" fill="#FEFECE" filter="url(#fpy34uyqqo0p3)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M96,1137.1094 L96,1164.1094 M83,1145.1094 L109,1145.1094 M96,1164.1094 L83,1179.1094 M96,1164.1094 L109,1179.1094 " fill="none" filter="url(#fpy34uyqqo0p3)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fpy34uyqqo0p3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="360" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="367" y="70.9951">Client Thread</text><rect fill="#FEFECE" filter="url(#fpy34uyqqo0p3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="360" y="1102.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="367" y="1122.8076">Client Thread</text><rect fill="#FEFECE" filter="url(#fpy34uyqqo0p3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="608" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="615" y="70.9951">Command Thread</text><rect fill="#FEFECE" filter="url(#fpy34uyqqo0p3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="608" y="1102.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="615" y="1122.8076">Command Thread</text><rect fill="#FEFECE" filter="url(#fpy34uyqqo0p3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="929" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="936" y="70.9951">Expensive Thread</text><rect fill="#FEFECE" filter="url(#fpy34uyqqo0p3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="929" y="1102.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="936" y="1122.8076">Expensive Thread</text><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="100.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="410" y="260.2266"/><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="410" y="573.5547"/><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="71.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="410" y="1014.5469"/><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="211.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="673" y="289.3594"/><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="169.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="673" y="602.6875"/><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="71.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="673" y="871.0156"/><rect fill="#FFFFFF" filter="url(#fpy34uyqqo0p3)" height="98.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="994" y="772.4844"/><path d="M312,101.2969 L312,156.2969 L513,156.2969 L513,111.2969 L503,101.2969 L312,101.2969 " fill="#FBFB77" filter="url(#fpy34uyqqo0p3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M503,101.2969 L503,111.2969 L513,111.2969 L503,101.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="318" y="118.3638">Thread of an application,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="318" y="133.4966">used to transfer commands</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="318" y="148.6294">to Command thread.</text><path d="M563,101.2969 L563,156.2969 L789,156.2969 L789,111.2969 L779,101.2969 L563,101.2969 " fill="#FBFB77" filter="url(#fpy34uyqqo0p3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M779,101.2969 L779,111.2969 L789,111.2969 L779,101.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="569" y="118.3638">Main thread of the library.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="569" y="133.4966">It executes biggest part of logic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="569" y="148.6294">that is implemented in Libindy</text><path d="M894,101.2969 L894,186.2969 L1100,186.2969 L1100,111.2969 L1090,101.2969 L894,101.2969 " fill="#FBFB77" filter="url(#fpy34uyqqo0p3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1090,101.2969 L1090,111.2969 L1100,111.2969 L1090,101.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="900" y="118.3638">Thread that is occasionally</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="900" y="133.4966">used for execution of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="900" y="148.6294">some heavy operations like</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="900" y="163.7622">credential definition creation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="900" y="178.895">or key derivation</text><rect fill="#EEEEEE" filter="url(#fpy34uyqqo0p3)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1106" x="3" y="216.5273"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1109" y1="216.5273" y2="216.5273"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1109" y1="219.5273" y2="219.5273"/><rect fill="#EEEEEE" filter="url(#fpy34uyqqo0p3)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="201" x="455.5" y="205.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="461.5" y="222.0278">Common command cycle</text><polygon fill="#A80036" points="398,256.2266,408,260.2266,398,264.2266,402,260.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="96" x2="404" y1="260.2266" y2="260.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="103" y="255.1606">indy_create_and_store_my_did</text><polygon fill="#A80036" points="661,285.3594,671,289.3594,661,293.3594,665,289.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="420" x2="667" y1="289.3594" y2="289.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="427" y="284.2935">CreateAndStoreMyDid</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="683" x2="725" y1="318.4922" y2="318.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="725" x2="725" y1="318.4922" y2="331.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="684" x2="725" y1="331.4922" y2="331.4922"/><polygon fill="#A80036" points="694,327.4922,684,331.4922,694,335.4922,690,331.4922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="690" y="313.4263">do_logic</text><polygon fill="#A80036" points="107,356.625,97,360.625,107,364.625,103,360.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="101" x2="414" y1="360.625" y2="360.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="113" y="355.5591">error code</text><path d="M8,373.625 L8,428.625 L181,428.625 L181,383.625 L171,373.625 L8,373.625 " fill="#FBFB77" filter="url(#fpy34uyqqo0p3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M171,373.625 L171,383.625 L181,383.625 L171,373.625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="14" y="390.6919">App waits for result</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="14" y="405.8247">asynchronously if there</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="14" y="420.9575">was no error before</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="683" x2="725" y1="459.1563" y2="459.1563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="725" x2="725" y1="459.1563" y2="472.1563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="684" x2="725" y1="472.1563" y2="472.1563"/><polygon fill="#A80036" points="694,468.1563,684,472.1563,694,476.1563,690,472.1563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="690" y="454.0903">execute callback</text><polygon fill="#A80036" points="107,497.2891,97,501.2891,107,505.2891,103,501.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="101" x2="677" y1="501.2891" y2="501.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="113" y="496.2231">result</text><rect fill="#EEEEEE" filter="url(#fpy34uyqqo0p3)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1106" x="3" y="529.8555"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1109" y1="529.8555" y2="529.8555"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1109" y1="532.8555" y2="532.8555"/><rect fill="#EEEEEE" filter="url(#fpy34uyqqo0p3)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="529" x="291.5" y="519.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="515" x="297.5" y="535.356">Expensive commands (key derivation, credential definition creation)</text><polygon fill="#A80036" points="398,569.5547,408,573.5547,398,577.5547,402,573.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="96" x2="404" y1="573.5547" y2="573.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="295" x="103" y="568.4888">indy_issuer_create_and_store_credential_def</text><polygon fill="#A80036" points="661,598.6875,671,602.6875,661,606.6875,665,602.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="420" x2="667" y1="602.6875" y2="602.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="427" y="597.6216">CreateAndStoreCredentialDefinition</text><polygon fill="#A80036" points="107,627.8203,97,631.8203,107,635.8203,103,631.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="101" x2="414" y1="631.8203" y2="631.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="113" y="626.7544">error code</text><path d="M8,644.8203 L8,699.8203 L181,699.8203 L181,654.8203 L171,644.8203 L8,644.8203 " fill="#FBFB77" filter="url(#fpy34uyqqo0p3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M171,644.8203 L171,654.8203 L181,654.8203 L171,644.8203 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="14" y="661.8872">App waits for result</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="14" y="677.02">asynchronously if there</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="14" y="692.1528">was no error before</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="683" x2="725" y1="730.3516" y2="730.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="725" x2="725" y1="730.3516" y2="743.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="684" x2="725" y1="743.3516" y2="743.3516"/><polygon fill="#A80036" points="694,739.3516,684,743.3516,694,747.3516,690,743.3516" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="690" y="725.2856">CreateCredentialDefinition</text><polygon fill="#A80036" points="982,768.4844,992,772.4844,982,776.4844,986,772.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="678" x2="988" y1="772.4844" y2="772.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="685" y="767.4185">new_credential_definition</text><path d="M565,785.4844 L565,840.4844 L786,840.4844 L786,795.4844 L776,785.4844 L565,785.4844 " fill="#FBFB77" filter="url(#fpy34uyqqo0p3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M776,785.4844 L776,795.4844 L786,795.4844 L776,785.4844 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="571" y="802.5513">Command thread can execute</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="571" y="817.6841">other commands during</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="571" y="832.8169">the work of expensive thread</text><polygon fill="#A80036" points="694,867.0156,684,871.0156,694,875.0156,690,871.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="688" x2="998" y1="871.0156" y2="871.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="700" y="865.9497">CreateAndStoreCredentialDefinitionContinue</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="683" x2="725" y1="900.1484" y2="900.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="725" x2="725" y1="900.1484" y2="913.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="684" x2="725" y1="913.1484" y2="913.1484"/><polygon fill="#A80036" points="694,909.1484,684,913.1484,694,917.1484,690,913.1484" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="690" y="895.0825">execute callback</text><polygon fill="#A80036" points="107,938.2813,97,942.2813,107,946.2813,103,942.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="101" x2="677" y1="942.2813" y2="942.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="113" y="937.2153">result</text><rect fill="#EEEEEE" filter="url(#fpy34uyqqo0p3)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1106" x="3" y="970.8477"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1109" y1="970.8477" y2="970.8477"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1109" y1="973.8477" y2="973.8477"/><rect fill="#EEEEEE" filter="url(#fpy34uyqqo0p3)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="148" x="482" y="960.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="134" x="488" y="976.3481">Synchronous calls</text><polygon fill="#A80036" points="398,1010.5469,408,1014.5469,398,1018.5469,402,1014.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="96" x2="404" y1="1014.5469" y2="1014.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="103" y="1009.481">indy_set_protocol_version</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="420" x2="462" y1="1043.6797" y2="1043.6797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="462" x2="462" y1="1043.6797" y2="1056.6797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="421" x2="462" y1="1056.6797" y2="1056.6797"/><polygon fill="#A80036" points="431,1052.6797,421,1056.6797,431,1060.6797,427,1056.6797" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="427" y="1038.6138">some config setup</text><polygon fill="#A80036" points="107,1081.8125,97,1085.8125,107,1089.8125,103,1085.8125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="101" x2="414" y1="1085.8125" y2="1085.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="113" y="1080.7466">error code</text><!--
@startuml
actor "Client app" as App
participant "Client Thread" as Client
note over Client
    Thread of an application,
    used to transfer commands
    to Command thread.
end note
participant "Command Thread" as Command
/ note over Command
    Main thread of the library.
    It executes biggest part of logic
    that is implemented in Libindy
end note
participant "Expensive Thread" as Expensive
/ note over Expensive
    Thread that is occasionally
    used for execution of
    some heavy operations like
    credential definition creation
    or key derivation
end note

==Common command cycle==
App -> Client: indy_create_and_store_my_did
activate Client
Client -> Command: CreateAndStoreMyDid
activate Command
Command -> Command: do_logic
Client - -> App: error code
note over App
    App waits for result
    asynchronously if there
    was no error before
end note
deactivate Client
Command -> Command: execute callback
Command - -> App: result
deactivate Command

==Expensive commands (key derivation, credential definition creation)==
App -> Client: indy_issuer_create_and_store_credential_def
activate Client
Client -> Command: CreateAndStoreCredentialDefinition
activate Command
Client - -> App: error code
deactivate Client
note over App
    App waits for result
    asynchronously if there
    was no error before
end note
Command -> Command: CreateCredentialDefinition
Command -> Expensive: new_credential_definition
deactivate Command
note over Command
    Command thread can execute
    other commands during
    the work of expensive thread
end note
activate Expensive
Expensive -> Command: CreateAndStoreCredentialDefinitionContinue
deactivate Expensive
activate Command
Command -> Command: execute callback
Command - -> App: result
deactivate Command

==Synchronous calls==
App -> Client: indy_set_protocol_version
activate Client
Client -> Client: some config setup
Client -> App: error code
deactivate Client
@enduml

PlantUML version 1.2019.08(Sat Jul 13 22:25:14 MSK 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1343-b26
Operating System: Linux
OS Version: 5.0.4-arch1-1-ARCH
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>