<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1348px" preserveAspectRatio="none" style="width:952px;height:1348px;" version="1.1" viewBox="0 0 952 1348" width="952px" zoomAndPan="magnify"><defs><filter height="300%" id="f16z2ieul6t5l3" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="259" y="229.9609"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="259" y="559.4219"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="259" y="1084.9453"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="486.5" y="259.0938"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="71.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="486.5" y="404.7578"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="169.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="486.5" y="588.5547"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="71.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="486.5" y="915.1484"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="129.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="486.5" y="1114.0781"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="854.9844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="727" y="317.3594"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="104" x2="104" y1="86.2969" y2="1261.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="264" x2="264" y1="86.2969" y2="1261.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="491.5" x2="491.5" y1="86.2969" y2="1261.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="731.5" x2="731.5" y1="86.2969" y2="1261.6094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="877.5" x2="877.5" y1="86.2969" y2="1261.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="66" y="82.9951">Client app</text><ellipse cx="104" cy="13" fill="#FEFECE" filter="url(#f16z2ieul6t5l3)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M104,21 L104,48 M91,29 L117,29 M104,48 L91,63 M104,48 L117,63 " fill="none" filter="url(#f16z2ieul6t5l3)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="66" y="1273.6045">Client app</text><ellipse cx="104" cy="1286.9063" fill="#FEFECE" filter="url(#f16z2ieul6t5l3)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M104,1294.9063 L104,1321.9063 M91,1302.9063 L117,1302.9063 M104,1321.9063 L91,1336.9063 M104,1321.9063 L117,1336.9063 " fill="none" filter="url(#f16z2ieul6t5l3)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f16z2ieul6t5l3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="209" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="216" y="70.9951">Client Thread</text><rect fill="#FEFECE" filter="url(#f16z2ieul6t5l3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="209" y="1260.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="216" y="1280.6045">Client Thread</text><rect fill="#FEFECE" filter="url(#f16z2ieul6t5l3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="421.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="428.5" y="70.9951">Command Thread</text><rect fill="#FEFECE" filter="url(#f16z2ieul6t5l3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="421.5" y="1260.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="428.5" y="1280.6045">Command Thread</text><rect fill="#FEFECE" filter="url(#f16z2ieul6t5l3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="682.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="689.5" y="70.9951">Pool Thread</text><rect fill="#FEFECE" filter="url(#f16z2ieul6t5l3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="682.5" y="1260.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="689.5" y="1280.6045">Pool Thread</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="820.5" y="82.9951">Pool with nodes</text><ellipse cx="878" cy="13" fill="#0000FF" filter="url(#f16z2ieul6t5l3)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M878,21 L878,48 M865,29 L891,29 M878,48 L865,63 M878,48 L891,63 " fill="none" filter="url(#f16z2ieul6t5l3)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="820.5" y="1273.6045">Pool with nodes</text><ellipse cx="878" cy="1286.9063" fill="#0000FF" filter="url(#f16z2ieul6t5l3)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M878,1294.9063 L878,1321.9063 M865,1302.9063 L891,1302.9063 M878,1321.9063 L865,1336.9063 M878,1321.9063 L891,1336.9063 " fill="none" filter="url(#f16z2ieul6t5l3)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="259" y="229.9609"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="259" y="559.4219"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="259" y="1084.9453"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="486.5" y="259.0938"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="71.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="486.5" y="404.7578"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="169.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="486.5" y="588.5547"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="71.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="486.5" y="915.1484"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="129.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="486.5" y="1114.0781"/><rect fill="#FFFFFF" filter="url(#f16z2ieul6t5l3)" height="854.9844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="727" y="317.3594"/><path d="M161,101.2969 L161,156.2969 L362,156.2969 L362,111.2969 L352,101.2969 L161,101.2969 " fill="#FBFB77" filter="url(#f16z2ieul6t5l3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M352,101.2969 L352,111.2969 L362,111.2969 L352,101.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="167" y="118.3638">Thread of an application,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="167" y="133.4966">used to transfer commands</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="167" y="148.6294">to Command thread.</text><path d="M376,101.2969 L376,156.2969 L602,156.2969 L602,111.2969 L592,101.2969 L376,101.2969 " fill="#FBFB77" filter="url(#f16z2ieul6t5l3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M592,101.2969 L592,111.2969 L602,111.2969 L592,101.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="382" y="118.3638">Main thread of the library.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="382" y="133.4966">It executes biggest part of logic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="382" y="148.6294">that is implemented in Libindy</text><path d="M616,101.2969 L616,141.2969 L843,141.2969 L843,111.2969 L833,101.2969 L616,101.2969 " fill="#FBFB77" filter="url(#f16z2ieul6t5l3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M833,101.2969 L833,111.2969 L843,111.2969 L833,101.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="622" y="118.3638">Thread used for communication</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="622" y="133.4966">with nodes in pool</text><rect fill="#EEEEEE" filter="url(#f16z2ieul6t5l3)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="937.5" x="3" y="186.2617"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="940.5" y1="186.2617" y2="186.2617"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="940.5" y1="189.2617" y2="189.2617"/><rect fill="#EEEEEE" filter="url(#f16z2ieul6t5l3)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="255" x="344.25" y="175.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="241" x="350.25" y="191.7622">Pool communication commands</text><polygon fill="#A80036" points="247,225.9609,257,229.9609,247,233.9609,251,229.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="104" x2="253" y1="229.9609" y2="229.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="111" y="224.895">indy_open_pool</text><polygon fill="#A80036" points="474.5,255.0938,484.5,259.0938,474.5,263.0938,478.5,259.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="269" x2="480.5" y1="259.0938" y2="259.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="276" y="254.0278">Open</text><polygon fill="#A80036" points="115,284.2266,105,288.2266,115,292.2266,111,288.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="263" y1="288.2266" y2="288.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="121" y="283.1606">error code</text><polygon fill="#A80036" points="715,313.3594,725,317.3594,715,321.3594,719,317.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="491.5" x2="721" y1="317.3594" y2="317.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="498.5" y="312.2935">Pool::new</text><polygon fill="#A80036" points="866,342.4922,876,346.4922,866,350.4922,870,346.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="737" x2="872" y1="346.4922" y2="346.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="744" y="341.4263">sync network</text><polygon fill="#A80036" points="748,371.625,738,375.625,748,379.625,744,375.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="742" x2="877" y1="375.625" y2="375.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="754" y="370.5591">fresh network info</text><polygon fill="#A80036" points="507.5,400.7578,497.5,404.7578,507.5,408.7578,503.5,404.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="501.5" x2="726" y1="404.7578" y2="404.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="513.5" y="399.6919">OpenAck</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="496.5" x2="538.5" y1="433.8906" y2="433.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="538.5" x2="538.5" y1="433.8906" y2="446.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="497.5" x2="538.5" y1="446.8906" y2="446.8906"/><polygon fill="#A80036" points="507.5,442.8906,497.5,446.8906,507.5,450.8906,503.5,446.8906" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="503.5" y="428.8247">execute callback</text><polygon fill="#A80036" points="115,472.0234,105,476.0234,115,480.0234,111,476.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="490.5" y1="476.0234" y2="476.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="121" y="470.9575">pool_handle</text><path d="M8,489.0234 L8,529.0234 L196,529.0234 L196,499.0234 L186,489.0234 L8,489.0234 " fill="#FBFB77" filter="url(#f16z2ieul6t5l3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M186,489.0234 L186,499.0234 L196,499.0234 L186,489.0234 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="14" y="506.0903">From now on pool works</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="14" y="521.2231">and requests can be sent</text><polygon fill="#A80036" points="247,555.4219,257,559.4219,247,563.4219,251,559.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="104" x2="253" y1="559.4219" y2="559.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="111" y="554.356">indy_submit_request</text><polygon fill="#A80036" points="474.5,584.5547,484.5,588.5547,474.5,592.5547,478.5,588.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="269" x2="480.5" y1="588.5547" y2="588.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="276" y="583.4888">SubmitRequest</text><polygon fill="#A80036" points="115,613.6875,105,617.6875,115,621.6875,111,617.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="263" y1="617.6875" y2="617.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="121" y="612.6216">error code</text><path d="M15,630.6875 L15,685.6875 L188,685.6875 L188,640.6875 L178,630.6875 L15,630.6875 " fill="#FBFB77" filter="url(#f16z2ieul6t5l3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M178,630.6875 L178,640.6875 L188,640.6875 L178,630.6875 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="21" y="647.7544">App waits for result</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="21" y="662.8872">asynchronously if there</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="21" y="678.02">was no error before</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="496.5" x2="538.5" y1="716.2188" y2="716.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="538.5" x2="538.5" y1="716.2188" y2="729.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="497.5" x2="538.5" y1="729.2188" y2="729.2188"/><polygon fill="#A80036" points="507.5,725.2188,497.5,729.2188,507.5,733.2188,503.5,729.2188" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="503.5" y="711.1528">send_tx</text><polygon fill="#A80036" points="715,754.3516,725,758.3516,715,762.3516,719,758.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="491.5" x2="721" y1="758.3516" y2="758.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="498.5" y="753.2856">_send_message</text><path d="M379,771.3516 L379,826.3516 L600,826.3516 L600,781.3516 L590,771.3516 L379,771.3516 " fill="#FBFB77" filter="url(#f16z2ieul6t5l3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M590,771.3516 L590,781.3516 L600,781.3516 L590,771.3516 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="385" y="788.4185">Command thread can execute</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="385" y="803.5513">other commands during</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="385" y="818.6841">the work of pool thread</text><polygon fill="#A80036" points="866,852.8828,876,856.8828,866,860.8828,870,856.8828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="737" x2="872" y1="856.8828" y2="856.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="744" y="851.8169">send(json)</text><polygon fill="#A80036" points="748,882.0156,738,886.0156,748,890.0156,744,886.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="742" x2="877" y1="886.0156" y2="886.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="754" y="880.9497">responses</text><polygon fill="#A80036" points="507.5,911.1484,497.5,915.1484,507.5,919.1484,503.5,915.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="501.5" x2="726" y1="915.1484" y2="915.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="513.5" y="910.0825">aggregated response</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="496.5" x2="538.5" y1="944.2813" y2="944.2813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="538.5" x2="538.5" y1="944.2813" y2="957.2813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="497.5" x2="538.5" y1="957.2813" y2="957.2813"/><polygon fill="#A80036" points="507.5,953.2813,497.5,957.2813,507.5,961.2813,503.5,957.2813" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="503.5" y="939.2153">execute callback</text><polygon fill="#A80036" points="115,982.4141,105,986.4141,115,990.4141,111,986.4141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="490.5" y1="986.4141" y2="986.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="121" y="981.3481">result</text><path d="M9,999.4141 L9,1054.4141 L195,1054.4141 L195,1009.4141 L185,999.4141 L9,999.4141 " fill="#FBFB77" filter="url(#f16z2ieul6t5l3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M185,999.4141 L185,1009.4141 L195,1009.4141 L185,999.4141 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="15" y="1016.481">When the work is over,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="15" y="1031.6138">you should close the pool</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="15" y="1046.7466">and it will kill the thread</text><polygon fill="#A80036" points="247,1080.9453,257,1084.9453,247,1088.9453,251,1084.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="104" x2="253" y1="1084.9453" y2="1084.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="111" y="1079.8794">indy_close_pool</text><polygon fill="#A80036" points="474.5,1110.0781,484.5,1114.0781,474.5,1118.0781,478.5,1114.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="269" x2="480.5" y1="1114.0781" y2="1114.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="276" y="1109.0122">Close</text><polygon fill="#A80036" points="115,1139.2109,105,1143.2109,115,1147.2109,111,1143.2109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="109" x2="263" y1="1143.2109" y2="1143.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="121" y="1138.145">error code</text><polygon fill="#A80036" points="720,1168.3438,730,1172.3438,720,1176.3438,724,1172.3438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="496.5" x2="726" y1="1172.3438" y2="1172.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="503.5" y="1167.2778">Pool::close</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="496.5" x2="538.5" y1="1201.4766" y2="1201.4766"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="538.5" x2="538.5" y1="1201.4766" y2="1214.4766"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="497.5" x2="538.5" y1="1214.4766" y2="1214.4766"/><polygon fill="#A80036" points="507.5,1210.4766,497.5,1214.4766,507.5,1218.4766,503.5,1214.4766" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="503.5" y="1196.4106">execute callback</text><polygon fill="#A80036" points="115,1239.6094,105,1243.6094,115,1247.6094,111,1243.6094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="109" x2="490.5" y1="1243.6094" y2="1243.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="121" y="1238.5435">error code</text><!--
@startuml
actor "Client app" as App
participant "Client Thread" as Client
note over Client
    Thread of an application,
    used to transfer commands
    to Command thread.
end note
participant "Command Thread" as Command
/ note over Command
    Main thread of the library.
    It executes biggest part of logic
    that is implemented in Libindy
end note
participant "Pool Thread" as Pool
/ note over Pool
    Thread used for communication
    with nodes in pool
end note
actor "Pool with nodes" as Nodes #blue
==Pool communication commands==
App -> Client: indy_open_pool
activate Client
Client -> Command: Open
activate Command
Client - -> App: error code
deactivate Client
Command -> Pool: Pool::new
deactivate Command
activate Pool
Pool -> Nodes: sync network
Nodes - -> Pool: fresh network info
Pool -> Command: OpenAck
activate Command
Command -> Command: execute callback 
Command - -> App: pool_handle
deactivate Command

note over App
    From now on pool works
    and requests can be sent
end note

App -> Client: indy_submit_request
activate Client
Client -> Command: SubmitRequest
activate Command
Client - -> App: error code
deactivate Client

note over App
    App waits for result
    asynchronously if there
    was no error before
end note
Command -> Command: send_tx
Command -> Pool: _send_message
note over Command
    Command thread can execute
    other commands during
    the work of pool thread
end note
deactivate Command
Pool -> Nodes: send(json)
Nodes -> Pool: responses
Pool - -> Command: aggregated response
activate Command
Command -> Command: execute callback 
Command - -> App: result
deactivate Command

note over App
    When the work is over,
    you should close the pool
    and it will kill the thread
end note

App -> Client: indy_close_pool
activate Client
Client -> Command: Close
activate Command
Client -> App: error code
deactivate Client
Command -> Pool: Pool::close
deactivate Pool
Command -> Command: execute callback 
Command - -> App: error code
deactivate Command
@enduml

PlantUML version 1.2019.08(Sat Jul 13 22:25:14 MSK 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1343-b26
Operating System: Linux
OS Version: 5.0.4-arch1-1-ARCH
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>